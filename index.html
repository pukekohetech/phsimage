<!doctype html>
<html lang="en" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>PHS Evidence Stamper</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#6e1818" />

  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="icon" sizes="192x192" href="icon-192.png">
  <link rel="icon" sizes="512x512" href="icon-512.png">

  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="app">

  <!-- HEADER -->
  <header class="app-header" style="margin-bottom:16px;">
    <h1 class="app-title" style="font-size:1.3rem;margin-bottom:6px;">
      PHS Evidence Stamper
    </h1>

    <div class="btn-row">
      <button id="initBtn" class="primary">üì∑ Enable Camera</button>
     
      <button id="installBtn" class="ghost" style="display:none;">‚¨áÔ∏è Install</button>
    </div>

    <div id="toast" class="toast"></div>
  </header>

  <!-- MAIN -->
  <section class="grid">

    <!-- CAMERA -->
    <div class="panel stack">
      <h2>Camera</h2>

      <!-- MEDIA WRAP: video + shield + overlay text -->
      <div class="media-wrap">
        <!-- Hidden canvas for processing -->
        <canvas id="canvas" width="1280" height="720" style="display:none;"></canvas>

        <!-- Live camera feed -->
        <video
          id="video"
          class="media"
          playsinline
          muted
          autoplay
        ></video>

        <!-- Shield overlay to match stamped image -->
        <img
          id="shieldOverlay"
          src="phs-shield.png"
          class="shield-overlay"
          alt=""
          aria-hidden="true"
        />

        <!-- WYSIWYG text overlay (updated by script.js) -->
        <div id="overlayText" class="stamp-overlay" aria-hidden="true">
          <span>
            Student ‚Äì Teacher<br>
            Pukekohe High School ‚Ä¢ Time<br>
            Subject / Project
          </span>
        </div>
      </div>

      <div class="btn-row" style="margin-top:10px;">
        <button id="shootBtn" class="primary" disabled>üì∏ Capture & Stamp</button>
        <button id="flipBtn" class="ghost">üîÑ Flip</button>
      </div>

      <div class="row row--2" style="margin-top:10px;">
        <div class="stack">
          <label for="fileInput">Upload a photo</label>
          <input id="fileInput" type="file" accept="image/*">
        </div>
        <div class="stack">
          <label>&nbsp;</label>
          <button id="fileStampBtn">Stamp File</button>
        </div>
      </div>
    </div>

    <!-- RESULT -->
    <div class="panel stack">
      <h2>Result</h2>

      <img id="preview" class="media" alt="Stamped image appears here">

      <div class="btn-row" style="margin-top:10px;">
        <button id="shareBtn" class="ghost" disabled>üì§ Share</button>
        <button id="downloadBtn" class="ghost" disabled>‚¨áÔ∏è Download</button>
        <button id="clearBtn" class="danger">Clear</button>
      </div>
    </div>

    <!-- DETAILS -->
    <div class="panel stack">
      <h2>Details</h2>

      <div class="stack">
        <label for="name">Student name</label>
        <input id="name" list="recentStudents" placeholder="Student name">
        <datalist id="recentStudents"></datalist>
      </div>

      <div class="row row--2">
        <div class="stack">
          <label for="teacherSelect">Teacher</label>
          <select id="teacherSelect"></select>
        </div>
        <div class="stack">
          <label for="teacherEmail">Email</label>
          <input id="teacherEmail" type="email">
        </div>
      </div>

      <div id="customTeacherGroup" class="row row--2" style="display:none;">
        <div class="stack">
          <label for="customTeacherName">Custom teacher</label>
          <input id="customTeacherName">
        </div>
        <div class="stack">
          <label>&nbsp;</label>
          <button id="copyEmailBtn">Copy</button>
        </div>
      </div>

      <div class="row row--2">
        <div class="stack">
          <label for="subjectSelect">Subject</label>
          <select id="subjectSelect"></select>
        </div>
        <div class="stack">
          <label for="projectSelect">Project</label>
          <select id="projectSelect"></select>
        </div>
      </div>

      <div id="customProjectGroup" class="stack" style="display:none%;">
        <label for="customProjectInput">Custom project</label>
        <input id="customProjectInput">
      </div>

      <div class="stack">
        <label for="subject">Custom text</label>
        <textarea id="subject" rows="2"></textarea>
      </div>
    </div>

    <!-- TEACHER LIST -->
    <div class="panel stack">
      <h2>Teachers</h2>
      <ul id="teacherList" class="teachers"></ul>
    </div>

  </section>
</div>

<script src="script.js?v=2025-02-10"></script>

<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('service-worker.js');
  });
}
</script>

</body>
</html>
